Detailed Table

SELECT staff.staff_id, staff.first_name, staff.last_name, payment.amount
FROM staff
INNER JOIN payment ON staff.staff_id = payment.staff_id
WHERE payment_date BETWEEN '2007-02-15' and '2007-02-21'
ORDER BY staff.staff_id

Summary Table

SELECT staff.staff_id, concat(staff.first_name, ' ', SUBSTRING(staff.last_name, 1, 1)) as name, SUM(payment.amount)
FROM staff
INNER JOIN payment ON staff.staff_id = payment.staff_id
WHERE payment_date BETWEEN '2007-02-15' and '2007-02-21'
GROUP BY staff.staff_id
ORDER BY SUM(payment.amount) DESC

CREATE FUNCTION name_first_l(num int)
RETURNS VARCHAR
LANGUAGE plpgsql
AS
$$
DECLARE name varchar;
BEGIN
	SELECT concat(staff.first_name, ' ', SUBSTRING(staff.last_name, 1, 1)) 
	INTO name;
	FROM staff
	WHERE staff.id=num
	RETURN name;
END;
$$

SELECT name_first_l(1);
